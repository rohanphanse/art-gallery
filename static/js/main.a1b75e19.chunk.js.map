{"version":3,"sources":["utils/config.js","utils/near.js","utils/contract.js","App.js","reportWebVitals.js","index.js"],"names":["CONTRACT_NAME","process","nearEnv","env","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","Error","environment","connect","Object","assign","deps","keyStore","keyStores","BrowserLocalStorageKeyStore","near","window","walletConnection","WalletConnection","accountId","getAccountId","contract","Contract","account","viewMethods","changeMethods","accountBalance","formatNearAmount","getAccountBalance","total","login","requestSignIn","logout","signOut","location","reload","generateId","Date","now","toString","substring","Math","random","setArtwork","artwork","id","heartOrUnheartArtwork","deleteArtwork","App","useState","artworks","updateArtworks","fetchArtworks","useCallback","getArtworks","useEffect","balance","updateBalance","fetchBalance","heartOrUnheartArtworkAndHandleError","alert","JSON","stringify","kind","deleteArtworkAndHandleError","name","updateName","description","updateDescription","image","updateImage","addArtwork","console","log","className","onClick","copy","sort","a","b","hearts","sortByHearts","map","src","alt","owner","onInput","event","target","value","jsx","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","nearInitPromise","initializeContract","ReactDOM","render","StrictMode","document","getElementById","catch","error"],"mappings":"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","file":"static/js/main.a1b75e19.chunk.js","sourcesContent":["const CONTRACT_NAME = process.env.CONTRACT_NAME || \"art-gallery2.roar123.testnet\"; \r\n\r\nexport default function environment(env) {\r\n    switch (env) {\r\n        case \"mainnet\": // line 5\r\n            return {\r\n                networkId: \"mainnet\",\r\n                nodeUrl: \"https://rpc.mainnet.near.org\",\r\n                contractName: CONTRACT_NAME,\r\n                walletUrl: \"https://wallet.near.org\",\r\n                helperUrl: \"https://helper.mainnet.near.org\",\r\n                explorerUrl: \"https://explorer.mainnet.near.org\",\r\n            };\r\n        case \"testnet\": // line 14\r\n            return {\r\n                networkId: \"testnet\",\r\n                nodeUrl: \"https://rpc.testnet.near.org\",\r\n                contractName: CONTRACT_NAME,\r\n                walletUrl: \"https://wallet.testnet.near.org\",\r\n                helperUrl: \"https://helper.testnet.near.org\",\r\n                explorerUrl: \"https://explorer.testnet.near.org\",\r\n            };\r\n        default:\r\n            throw Error(`Unknown environment '${env}'.`);\r\n    }\r\n}","import environment from \"./config\";\r\nimport { connect, Contract, keyStores, WalletConnection } from \"near-api-js\";\r\nimport { formatNearAmount } from \"near-api-js/lib/utils/format\";\r\n\r\nconst nearEnv = environment(\"testnet\");\r\n\r\nexport async function initializeContract() {\r\n    const near = await connect(\r\n        Object.assign(\r\n            { deps: { keyStore: new keyStores.BrowserLocalStorageKeyStore() } },\r\n            nearEnv\r\n        )\r\n    );\r\n    window.walletConnection = new WalletConnection(near);\r\n    window.accountId = window.walletConnection.getAccountId();\r\n    window.contract = new Contract(\r\n        window.walletConnection.account(),\r\n        nearEnv.contractName,\r\n        {\r\n            viewMethods: [\"getArtwork\", \"getArtworks\"],\r\n            changeMethods: [\"setArtwork\", \"deleteArtwork\", \"heartOrUnheartArtwork\"],\r\n        }\r\n    );\r\n}\r\n\r\nexport async function accountBalance() {\r\n    return formatNearAmount(\r\n        (await window.walletConnection.account().getAccountBalance()).total,\r\n        2\r\n    );\r\n}\r\n\r\nexport async function getAccountId() {\r\n    return window.walletConnection.getAccountId();\r\n}\r\n\r\nexport function login() {\r\n    window.walletConnection.requestSignIn(nearEnv.contractName);\r\n}\r\n\r\nexport function logout() {\r\n    window.walletConnection.signOut();\r\n    window.location.reload();\r\n}","// Generate 6 character long id\r\nfunction generateId() {\r\n    return Date.now().toString(36).substring(6, 8) + Math.random().toString(36).substring(2, 6);\r\n}\r\n\r\nexport async function setArtwork(artwork) {\r\n    artwork.id = generateId();\r\n    return await window.contract.setArtwork({ artwork })\r\n}\r\n\r\nexport function getArtworks() {\r\n    return window.contract.getArtworks();\r\n}\r\n\r\nexport async function heartOrUnheartArtwork(id) {\r\n    return await window.contract.heartOrUnheartArtwork({ id });\r\n}\r\n\r\nexport async function deleteArtwork(id) {\r\n    return await window.contract.deleteArtwork({ id });\r\n}","import React, { useState, useEffect, useCallback } from \"react\";\nimport { accountBalance, login, logout } from \"./utils/near\";\nimport { getArtworks, heartOrUnheartArtwork, deleteArtwork, setArtwork } from \"./utils/contract\";\n\nfunction App() {\n    const account = window.walletConnection.account();\n    // Artworks\n    const [artworks, updateArtworks] = useState([]);\n    const fetchArtworks = useCallback(async () => {\n        if (account.accountId) {\n            updateArtworks(await getArtworks());\n        }\n    }, [account.accountId]);\n    useEffect(() => {\n        fetchArtworks();\n    }, [fetchArtworks]);\n    // Balance\n    const [balance, updateBalance] = useState(\"0\");\n    const fetchBalance = useCallback(async () => {\n        if (account.accountId) {\n            updateBalance(await accountBalance());\n        }\n    }, [account.accountId]);\n    useEffect(() => {\n        fetchBalance();\n    }, [fetchBalance])\n    \n    async function heartOrUnheartArtworkAndHandleError(id) {\n        try {\n            await heartOrUnheartArtwork(id);\n            fetchArtworks();\n        } catch (error) {\n            alert(JSON.stringify(error.kind));\n        }\n    }\n\n    async function deleteArtworkAndHandleError(id) {\n        try {\n            await deleteArtwork(id);\n            fetchArtworks();\n        } catch (error) {\n            alert(JSON.stringify(error.kind));\n        }\n    }\n\n    const [name, updateName] = useState(\"\");\n    const [description, updateDescription] = useState(\"\");\n    const [image, updateImage] = useState(\"\");\n\n    async function addArtwork() {\n        console.log(name, description, image);\n        try {\n            await setArtwork({\n                name,\n                description,\n                image\n            })\n            fetchArtworks();\n        } catch (error) {\n            alert(JSON.stringify(error.kind));\n        }\n    }\n\n    function sortByHearts(artworks) {\n        const copy = [...artworks];\n        console.log(copy)\n        copy.sort((a, b) => b.hearts - a.hearts);\n        console.log(copy)\n        return copy;\n    }\n\n    return (\n        <>\n            <div className = \"title\">Decentralized Art Gallery by Rohan Phanse</div>\n            {account.accountId ? (\n                <>\n                    <div>{account.accountId}</div>\n                    <div>Balance: {balance} NEAR</div>\n                    <button onClick={logout}>LOG OUT</button>\n                    <div className = \"center\">\n                        <div className = \"artworks\">\n                            {sortByHearts(artworks).map((artwork) => (\n                                <div className = \"artwork\" key = {artwork.id}>\n                                    <img src = {artwork.image} alt = {artwork.name} />\n                                    <div>{artwork.name}</div>\n                                    <div className = \"desc\">{artwork.description}</div>\n                                    <div>{artwork.id}</div>\n                                    <div>{artwork.owner}</div>\n                                    <button onClick = {async () => await heartOrUnheartArtworkAndHandleError(artwork.id)}>{artwork.hearts} ❤️</button>\n                                    {account.accountId === artwork.owner ? <button onClick = {async () => await deleteArtworkAndHandleError(artwork.id)}>❌</button> : \"\"}                                </div>\n                            ))}\n                        </div>\n                    </div>\n                    <div>Add artwork:</div>\n                    <div id = \"add-artwork-form\">\n                        <div>Name: <input id = \"name-input\" onInput = {(event) => updateName(event.target.value)}/></div>\n                        <div>Description: <textarea id = \"desc-input\" onInput = {(event) => updateDescription(event.target.value)}></textarea></div>\n                        <div>Image URL: <input id = \"image-input\" onInput = {(event) => updateImage(event.target.value)}/></div>\n                        <button id = \"add-button\" onClick = {async () => await addArtwork()}>Add</button>\n                    </div>\n                </>\n            ) : (\n                <button onClick={login}>CONNECT WALLET</button>\n            )}\n            <style jsx>{`\n                .title {\n                    font-style: italic;\n                }\n\n                .center {\n                    display: flex;\n                    flex-direction: row;\n                    justify-content: center;\n                }\n\n                .artworks {\n                    display: grid;\n                    grid-template-columns: repeat(3, 1fr);\n                    width: 600px;\n                    grid-gap: 20px;\n                    align-items: center;\n                }\n\n                .artwork {\n                    display: flex;\n                    flex-direction: column;\n                    justify-content: center;\n                    align-items: center;\n                }\n\n                .artwork img {\n                    width: 200px;\n                    height: 200px;\n                    object-fit: contain;\n                }\n\n                .artwork .desc {\n                    font-style: italic;\n                }\n            `}</style>\n        </>\n    );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { initializeContract } from \"./utils/near\";\n\nwindow.nearInitPromise = initializeContract()\n    .then(() => {\n        ReactDOM.render(\n            <React.StrictMode>\n                <App />\n            </React.StrictMode>,\n            document.getElementById(\"root\")\n        );\n    })\n    .catch(console.error);\n\nreportWebVitals();"],"sourceRoot":""}